<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>QDaq: QDaq scripting API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">QDaq
   &#160;<span id="projectnumber">0.2.6</span>
   </div>
   <div id="projectbrief">Qt-based Data Aqcuisition</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">QDaq scripting API</div>  </div>
</div><!--header-->
<div class="contents">

<p>A Javascript API for QDaq based on QtScript.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for QDaq scripting API:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group___script_a_p_i.png" border="0" alt="" usemap="#group______script__a__p__i"/>
<map name="group______script__a__p__i" id="group______script__a__p__i">
<area shape="rect" id="node1" href="group___core.html" title="Classes that define the core functionality of QDaq objects. " alt="" coords="289,56,426,83"/><area shape="rect" id="node3" href="group___daq.html" title="Classes that can be used for data aqcuisition tasks. " alt="" coords="289,107,426,133"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_byte_array_prototype.html">ByteArrayPrototype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The prototype for the ByteArray class.  <a href="class_byte_array_prototype.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_channel.html">QDaqChannel</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class that represent a stream of numerical data, a signal.  <a href="class_q_daq_channel.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_data_buffer.html">QDaqDataBuffer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class that provides storage of channel or other data.  <a href="class_q_daq_data_buffer.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_job.html">QDaqJob</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class for objects that perform a specific task reqursively.  <a href="class_q_daq_job.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_loop.html">QDaqLoop</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class encapsulating a software loop.  <a href="class_q_daq_loop.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_object.html">QDaqObject</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class of all QDaq objects.  <a href="class_q_daq_object.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_vector_prototype.html">VectorPrototype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The prototype for the Vector class.  <a href="class_vector_prototype.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_device.html">QDaqDevice</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class representing a DAQ device.  <a href="class_q_daq_device.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>A Javascript API for QDaq based on QtScript. </p>
<p>QDaq offers a Javascript interface via the QtScript module.</p>
<p>One can use this scripting interface either to allow some user-defined behavior at some point inside a larger C++ application or alternatively to build the complete application in the scripting language.</p>
<p>It is possible to create QDaq objects from Javascript. These objects will continue to exist after the scripting session ends, as long as they become part of the QDaq object tree. Thus, complete aqcuisition loops can be created and executed in javascript in the same way as in C++.</p>
<p>Creation of GUI components and interaction between them and the QDaq objects can also be done using Javascript.</p>
<p>The scripting interface is based on the Qt meta-object system. When a QDaq object is exposed to the scripting environment, the signals and slots the QDaqObject-based class are available as methods of the javascript object. These methods can be called from javascript with the same arguments as in C++.</p>
<p>Similarly, the Qt properties of the C++ class become properties of the javascript object and can be read or changed from Javascript.</p>
<p>QDaq objects has been designed so that the API they offer to Javascript (i.e., their signals, slots and properties) are sufficient to work with the objects for most purposes. Only a few special functions or QDaq extensions are acomplished only in C++.</p>
<p>The QDaq class documentation serves also as documentation of the scripting API as far as the signals, slots and properties of each class are concerned.</p>
<h1><a class="anchor" id="Started"></a>
Getting started with QDaq scripting</h1>
<p>The easiest way to get started with QDaq scripting is to start the <a class="el" href="qdaq_app.html">qdaq</a> application, open a scripting console and start executing Javascript commands interactively.</p>
<p>The QDaq root object (<a class="el" href="class_q_daq_object.html#a9f3d71496598a421c34fc099bcfcb1ae" title="Obtain a pointer to the one-and-only QDaqRoot object. ">QDaqObject::root()</a>) is already defined in Javascript as the global property "qdaq".</p>
<p>If you type "qdaq" at the prompt and press enter the system reponds by showing that this is an object of class <a class="el" href="class_q_daq_root.html" title="QDaq root object class. ">QDaqRoot</a> with name "qdaq". Similarly if you check the "this" object the system reponds that it is an object of class QDaqSession:</p>
<pre class="fragment">&gt;&gt; qdaq
QDaqRoot(name = "qdaq")
&gt;&gt; this
QDaqSession(name = "session0")
&gt;&gt;
</pre><p>You will notice that the console has object introspection, i.e., pressing the '.' after a valid Javascript expression the system lists all properties and method of a given object.</p>
<h1><a class="anchor" id="Create"></a>
Creating objects in scripts</h1>
<p>All the classes <a href="#nested-classes">listed above </a> can be created in the scripting environment by the Javascript new operator with a single parameter, the object name</p>
<div class="fragment"><div class="line">var x = <span class="keyword">new</span> <a class="code" href="class_q_daq_object.html">QDaqObject</a>(<span class="stringliteral">&quot;objname&quot;</span>);</div>
</div><!-- fragment --><p>A hierarchy of QDaq objects can be built by using the <a class="el" href="class_q_daq_object.html" title="Base class of all QDaq objects. ">QDaqObject</a> <a class="el" href="class_q_daq_object.html#domapi">domapi</a>. Here is an example of script code that creates a loop with 2 channels:</p>
<div class="fragment"><div class="line"><span class="comment">// create a loop</span></div>
<div class="line">var loop = <span class="keyword">new</span> <a class="code" href="class_q_daq_loop.html">QDaqLoop</a>(<span class="stringliteral">&quot;loop&quot;</span>);</div>
<div class="line"><span class="comment">// create a clock channel</span></div>
<div class="line">var t = <span class="keyword">new</span> <a class="code" href="class_q_daq_channel.html">QDaqChannel</a>(<span class="stringliteral">&quot;t&quot;</span>);</div>
<div class="line">t.type = <span class="stringliteral">&quot;Clock&quot;</span>;</div>
<div class="line"><span class="comment">// create a test random channel</span></div>
<div class="line">var ch1 =  <span class="keyword">new</span> <a class="code" href="class_q_daq_channel.html">QDaqChannel</a>(<span class="stringliteral">&quot;ch1&quot;</span>);</div>
<div class="line">ch1.type = <span class="stringliteral">&quot;Random&quot;</span>;</div>
<div class="line"><span class="comment">// create a 2nd channel</span></div>
<div class="line">var ch2 = <span class="keyword">new</span> <a class="code" href="class_q_daq_channel.html">QDaqChannel</a>(<span class="stringliteral">&quot;ch2&quot;</span>);</div>
<div class="line"><span class="comment">// create a script job</span></div>
<div class="line"><span class="comment">// that will write to ch2 the square root of ch1</span></div>
<div class="line">var scr = <span class="keyword">new</span> <a class="code" href="class_q_daq_job.html">QDaqJob</a>(<span class="stringliteral">&quot;scr&quot;</span>);</div>
<div class="line">scr.code = <span class="stringliteral">&quot;var v = qdaq.loop.ch1.value(); qdaq.loop.ch2.push(Math.sqrt(v));&quot;</span></div>
<div class="line"><span class="comment">// build the object hierarchy under the root object &quot;qdaq&quot;</span></div>
<div class="line">loop.appendChild(t);</div>
<div class="line">loop.appendChild(ch1);</div>
<div class="line">loop.appendChild(scr);</div>
<div class="line">loop.appendChild(ch2);</div>
<div class="line">qdaq.appendChild(loop);</div>
</div><!-- fragment --><p>After the above script code has been executed a call to objectTree() would return the following: </p>
<pre class="fragment">&gt;&gt; qdaq.objectTree()
qdaq
|--loop
|  |--t
|  |--ch1
|  |--scr
|  |--ch2
</pre><h1><a class="anchor" id="Hierarchy"></a>
Traversing the object hierarchy</h1>
<p>The are many ways to traverse the QDaq object hierarchy from Javascript.</p>
<p>All objects are descendants of the root object "qdaq". The child objects of an object are Javascript properties of that object. Thus, in the above example we can obtain the object "ch2" like this</p>
<div class="fragment"><div class="line">var my_ch2 = qdaq.loop.ch2;</div>
</div><!-- fragment --><p>Alternatively, if we do not know the path to the object, we can use the built-in QtScript functions findChild and findChildren which try to find an object based on its name. All QDaq object must have a name! Thus, to obtain "ch2" with this method we would do</p>
<div class="fragment"><div class="line">var my_ch2 = qdaq.findChild(<span class="stringliteral">&quot;ch2&quot;</span>);</div>
</div><!-- fragment --><p>If there are more than one descendant objects with the same name, findChild() will return the 1st that it will find (closer relatives are discovered first). The function findChildren will return an array of all objects with the same name.</p>
<h1><a class="anchor" id="Threads"></a>
Interactive vs in-loop Javascript</h1>
<p>There two different kinds of Javascript environments in QDaq.</p>
<p>The 1st one runs in the main application thread and can execute either interactively on a console or in the background running some script. This kind of environment has typically access to all application objects: the QDaq object hierarchy, the UI widgets, the special functions for system interaction (filesystem, command execution) etc</p>
<p>QDaq has one standard such Javascript environment that is never deleted and it is called "root script session". It can be accesed by the function <a class="el" href="class_q_daq_root.html#ae5bed36b118927b2c910e8d7dba3fc10" title="Returns a pointer to the root script session. ">QDaqRoot::rootSession()</a>. If we need to define Jacascript functions that must exist throught the lifetime of the application, then we have to define them in the root session. A typical example of such a function is when we want to define UI logic in Javascript, e.g. a button press calls a Javascript funtion that performs the required action.</p>
<p>A second kind of Javascript environment exists only within a <a class="el" href="class_q_daq_loop.html" title="A class encapsulating a software loop. ">QDaqLoop</a> and it serves the purpose of running code of the loop's <a class="el" href="class_q_daq_job.html" title="Base class for objects that perform a specific task reqursively. ">QDaqJob</a> objects. This environment runs in the separate loop thread and has only access to the QDaq objects via the qdaq global object.</p>
<p>If we have <a class="el" href="class_q_daq_job.html" title="Base class for objects that perform a specific task reqursively. ">QDaqJob</a> objects that need to run Javascript code during execution of their parent loop, then we must create a scripting engine at the top-level loop by calling <a class="el" href="class_q_daq_loop.html#a599396e9e90ad42df14aa1157f169e46" title="Create a dedicated QDaqScriptEngine. ">QDaqLoop::createLoopEngine()</a>.</p>
<h1><a class="anchor" id="UI"></a>
Creating user interface (UI) components</h1>
<p>In Javascript UI components can be loaded from *.ui files that have been created by QtDesigner or QtCreator.</p>
<p>There are 2 functions to accomplish this: QDaqSession::loadUi() and QDaqSession::loadTopLevelUi().</p>
<p>Both take a *.ui file name as input and generate a QWidget according to the specifications in the file. The simple loadUi() function generates a bare QWidget whereas loadTopLevelUi() generates a top level QDaq window. Using these two functions, a complete UI can be built. This is shown in the following code example.</p>
<p>The main application window is a tab widget with 2 tabs. We create it in QtDesigner and give each of the tabs a representative name. The form we create in QtDesigner should be a plain QWidget or a QTabWidget. Do not use a QMainWindow or other top-level widget types.</p>
<p>We additionally create in QtDesigner two widgets that contain all the components (buttons, display fields, etc) that we need in each tab.</p>
<p>The following QDaq script code creates the widgets and combines them to form the final application window.</p>
<div class="fragment"><div class="line"><span class="comment">// create top level application window - a tab widget</span></div>
<div class="line">var w = loadTopLevelUi(<span class="stringliteral">&#39;tabwidget.ui&#39;</span>,<span class="stringliteral">&#39;mainForm&#39;</span>);</div>
<div class="line"><span class="comment">// create the widget for the 1st tab</span></div>
<div class="line">var to = loadUi(<span class="stringliteral">&#39;tab1.ui&#39;</span>);</div>
<div class="line"><span class="comment">// find the current 1st tab widget in the main window</span></div>
<div class="line">var from = w.findChild(<span class="stringliteral">&#39;tab1&#39;</span>);</div>
<div class="line"><span class="comment">// replace it with the one loaded from the file</span></div>
<div class="line">w.replaceWidget(from,to);</div>
<div class="line"><span class="comment">// repeat for the second tab</span></div>
<div class="line">to = loadUi(<span class="stringliteral">&#39;tab2.ui&#39;</span>);</div>
<div class="line">from = w.findChild(<span class="stringliteral">&#39;tab2&#39;</span>);</div>
<div class="line">w.replaceWidget(from,to);</div>
</div><!-- fragment --><p>To be able to locate the various UI components we have to give them a name in QtDesigner. Then, when a form is loaded in Javascript, use findChild() or findChildren() to get the UI widgets.</p>
<h1><a class="anchor" id="FullApp"></a>
Creating a full app in Javascript</h1>
<p>To create a full QDaq application in Javascript the following steps are needed:</p>
<ul>
<li>Create the user interface forms with QtDesigner or QtCreator</li>
<li>Write a script that loads the UI files and defines the UI logic</li>
<li>Implement the main application DAQ tasks by means of QDaq objects</li>
<li>Start your QDaq loops</li>
</ul>
<p>The application can be executed with the <a class="el" href="qdaq_app.html">qdaq</a> application.</p>
<p>A recomended folder organization is to have a root folder with the application name, a subfolder named "scripts" for the script files and a subfolder named "ui" for the *.ui files. Then <a class="el" href="qdaq_app.html">qdaq</a> is run from the root folder </p>
<div class="fragment"><div class="line">&gt;qdaq scripts/main.js</div>
</div><!-- fragment --><p> assuming that "main.js" is the application script.</p>
<p>QDaq will create a "log" subfolder to store its log files.</p>
<h1><a class="anchor" id="Extensions"></a>
QDaq Javascript tricks</h1>
<p>QDaq defines some special Javascript objects.</p>
<p>The <a class="el" href="class_byte_array_prototype.html" title="The prototype for the ByteArray class. ">ByteArrayPrototype</a> class defines essentially a new Javascript object class named "ByteArray" that allows low-level manipulation of arrays of bytes. This is usefull for DAQ work, when we need byte-wise memory access which is not possible by default in Javascript.</p>
<p>C++ Enumeration types that are properties of QDaq objects are manipulated from Javascript by strings with the enumeration name that appears in C++ code. E.g., to set the <a class="el" href="class_q_daq_channel.html#aeedd7ab3fa27546657492724e32c85d7" title="Option for formatting channel data for textual representation. ">QDaqChannel::format</a> property we pass a string</p>
<div class="fragment"><div class="line"><span class="comment">// Create a QDaq channel and set the number format to fixed point</span></div>
<div class="line">var ch = <span class="keyword">new</span> <a class="code" href="class_q_daq_channel.html">QDaqChannel</a>(<span class="stringliteral">&quot;ch1&quot;</span>);</div>
<div class="line">ch.format = <span class="stringliteral">&quot;FixedPoint&quot;</span>;</div>
</div><!-- fragment --><h1><a class="anchor" id="Synopsis"></a>
A synopsis of QDaq objects</h1>
<ul>
<li><a class="el" href="class_q_daq_object.html" title="Base class of all QDaq objects. ">QDaqObject</a></li>
</ul>
<p>Directly derived from Qt’s QObject</p>
<ul>
<li><a class="el" href="class_q_daq_root.html" title="QDaq root object class. ">QDaqRoot</a></li>
</ul>
<p>The easier way to visualize the hierarchy of objects of the running qdaq session is to use the Object Browser window of the QDaq IDE. There, all the objects are represented in tree form. The base qdaq object is a <a class="el" href="class_q_daq_root.html" title="QDaq root object class. ">QDaqRoot</a> object.</p>
<ul>
<li>QDaqSession</li>
</ul>
<p>The basic instance of an interaction with all other existing objects and ui’s that do all the work in data taking. It is designed to function in JS, by providing an “interface” or “translation service” to C++/Qt’s objects to JS much more nimble and low-weight, pointer-based objects. Any qdaq console is a QDaqSession object.</p>
<ul>
<li><a class="el" href="class_q_daq_job.html" title="Base class for objects that perform a specific task reqursively. ">QDaqJob</a></li>
</ul>
<p>“Anything that actively <em>does</em> something” (instead of just existing) in QDaq.</p>
<ul>
<li><a class="el" href="class_q_daq_channel.html" title="A class that represent a stream of numerical data, a signal. ">QDaqChannel</a></li>
</ul>
<p>The basic object for interaction with instruments and data taking, keeping and interacting with measurements.</p>
<ul>
<li><a class="el" href="class_q_daq_interface.html" title="Base class of objects representing digital communications interfaces. ">QDaqInterface</a></li>
</ul>
<p><a class="el" href="class_q_daq_interface.html" title="Base class of objects representing digital communications interfaces. ">QDaqInterface</a> provides a common way to communicate with (hardware) instruments. The actual communication interface of the instruments connected to the control computer may vary (examples include GPIB, TCP/IP and Modbus protocols).</p>
<p>A <a class="el" href="class_q_daq_interface.html" title="Base class of objects representing digital communications interfaces. ">QDaqInterface</a> has a number of communication "ports", which have different meaning depending on the specific interface implementation. On memory/register based interfaces like MODBUS, a port represents the register number to be read/written. On interfaces that support connection with multiple instruments (GPIB, RS485), the port is essentially the address of each instrument. On interfaces that support only one-to-one communication with an instrument (RS232, TCP/IP) the port feature is not used.</p>
<ul>
<li><a class="el" href="class_q_daq_device.html" title="A class representing a DAQ device. ">QDaqDevice</a></li>
</ul>
<p>A <a class="el" href="class_q_daq_device.html" title="A class representing a DAQ device. ">QDaqDevice</a> is the software representation of a hardware device connected to the control computer.</p>
<p>In order for the computer to interact with a device, the device and its interface have to be created as software objects, and the device has to be assigned to an interface. Then, both the interface and the device have to be opened. At that point, the user can communicate with the device (send commands or get measurements), according to each devices specific communication protocols (e.g. SCPI commands or even whole scripts), using just the read() and write() functions.</p>
<ul>
<li>QDaqFilter</li>
</ul>
<p>A QDaqFilter is the software implementation of a mathematical process (usually quite complicated), that has to be applied online to the values of one or more QDaqChannels.</p>
<p>At present, QDaqFilters can be:</p>
<ul>
<li>FOPDT (First-Order-Plus-Dead-Time control)</li>
<li>Interpolator (As the name shows, finds values between measured or available ones)</li>
<li>Linear Correlator (Finds correlation -linear fitter- between values presented)</li>
<li>PID (Proportional-Integral-Differential control)</li>
</ul>
<p>These of course are not all "filters" in the common use of the term.</p>
<ul>
<li><a class="el" href="class_q_daq_data_buffer.html" title="A class that provides storage of channel or other data. ">QDaqDataBuffer</a></li>
</ul>
<p>The basic object of data keeping, where the actual values measured are kept in memory, relatively organized, before being saved to disk.</p>
<p>Thought the object can function in two alternative ways, either by attaching to QDaqChannels and reading their content, or by getting values pushed independently by the user, in practice only the first way of data logging is used.</p>
<p>The data logging involves 4 different objects, 2 QLists:</p>
<ul>
<li>channel_objects is a QDaqObjectList, i.e. a QList&lt;QDaqObject&gt;</li>
<li>columnNames_ is a QStringList, i.e. a QList&lt;QString&gt;</li>
</ul>
<p>This stores the names of the columns in the sense of C++/Qt object names (which may be different from the user interface channel names!). This is done in order to have a human-friendly way to access the two following objects.</p>
<p>And 2 QVectors:</p>
<ul>
<li>data_matrix is a QVector of <a class="el" href="class_q_daq_vector.html" title="A buffer for storing double numbers. ">QDaqVector</a> objects QVector&lt;QDaqVector&gt;</li>
</ul>
<p><a class="el" href="class_q_daq_vector.html" title="A buffer for storing double numbers. ">QDaqVector</a> is a special QDaq class holding QExplicitlySharedDataPointer objects to other special QDaq objects (essentially lists of double numbers), see below. data_matrix is where the data are actually read into, and kept. It can be thought of as a 2-D matrix, where each column represents a channel (<a class="el" href="class_q_daq_channel.html" title="A class that represent a stream of numerical data, a signal. ">QDaqChannel</a>), and each row a measurement point (presumably done at every iteration of a loop containing the <a class="el" href="class_q_daq_data_buffer.html" title="A class that provides storage of channel or other data. ">QDaqDataBuffer</a>, and presumably sync’d with the measurements of the channels. (See below about the concept of a depth of a data channel).</p>
<ul>
<li>channel_ptrs This is a QVector holding QPointers to QDaqChannels, i.e. a QVector&lt;QPointer&lt;QDaqChannel&gt;&gt;. This gives an extra handle to interact with the constituents</li>
</ul>
<p>These four objects have to change in unison in order for the data recording to be well behaved, and therefore all 4 of them have to be in principle interacted with when interacting with data.</p>
<p>Qt has tried to provide all methods available to QList also to QVector objects, and vice-versa, hence all four objects can be treated almost in the same way</p>
<p>It is also implicitly true that the order of objects (QDaqChannels, names, pointers, data columns) is the same across all 4 objects, to facilitate access, although the objects are not absolutely ordered in any sense.</p>
<p>A data recording loop that runs without input (e.g. a loop containing a <a class="el" href="class_q_daq_data_buffer.html" title="A class that provides storage of channel or other data. ">QDaqDataBuffer</a> that is not running concurrently with any data-producing, i.e. QDaqChannel-containing loop, is filled with zeros. This behaviour may need to change, in order to separate “real” zero values from accidental no input.</p>
<p><em>Depth</em></p>
<p>If the thread of data creation in a channel is too busy to communicate available data to the thread of data recording (e.g. during very fast loops), data are pushed in a provisional “buffer”. This process changes the value of special indexes (semaphores), that alert the data recording thread that data is available. The number of positions of this provisional buffer can be set for each channel, and is the (data) channel’s “depth” properties</p>
<p>In order for a data channel to be created and deleted successfully, care must be taken to also ‘populate’ or ‘depopulate’ its properties also.</p>
<h1><a class="anchor" id="Ref"></a>
Further reading</h1>
<p>For QDaq objects and their Javascript API refer to the documentation of the <a href="#nested-classes">classes listed above</a> and other QDaq classes. All properties, signals and slots are available in Javascript and essentially constitute the QDaq Scripting API.</p>
<p>Resources for Javascript and QtScript:</p>
<ul>
<li>An excellent book for Javascript is "JavaScript: the definitive guide" by D. Flanagan.</li>
<li>Mozilla offers many Javascript resources at <a href="https://developer.mozilla.org/en-US/docs/Web/javascript">developer.mozilla.org.</a></li>
<li>Also the W3 organization has Javascript material here <a href="https://www.w3schools.com/js/DEFAULT.asp">www.w3schools.com.</a></li>
<li>The QtScript module documentation from the official Qt web-site <a href="https://doc.qt.io/qt-5/qtscript-index.html">doc.qt.io.</a> explains many implementation details on the C++/Javascript duality.</li>
<li>The QtScript Javascript engine implements the ECMA-262 language standard which is described <a href="https://doc.qt.io/qt-5/ecmascript.html">here.</a> </li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 15 2020 17:03:21 for QDaq by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
